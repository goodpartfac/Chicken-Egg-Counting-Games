<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏Å‡∏°‡∏ô‡∏±‡∏ö ‡πÑ‡∏Å‡πà ‡πÑ‡∏Ç‡πà ‡∏°‡∏´‡∏≤‡∏™‡∏ô‡∏∏‡∏Å - ‡∏Ñ‡∏£‡∏π‡∏Ç‡∏±‡∏ô‡∏ó‡∏≠‡∏á ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡πÄ‡∏ï‡∏µ‡πâ‡∏¢</title>
    <link href="https://fonts.googleapis.com/css2?family=Kodchasan:wght@600;700&family=Sarabun:wght@600;800&family=Chonburi&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kodchasan', sans-serif; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden; position: relative; background: #81D4FA; }
        .sky-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(to bottom, #29B6F6 0%, #B3E5FC 70%, #E1F5FE 100%); }
        .hill-far { position: fixed; bottom: 0; left: -10%; width: 120%; height: 45%; background: #9CCC65; border-radius: 100% 100% 0 0; z-index: -5; }
        .hill-near { position: fixed; bottom: -10%; right: -10%; width: 110%; height: 40%; background: #7CB342; border-radius: 100% 100% 0 0; z-index: -4; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); }
        header { text-align: center; background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); padding: 20px; border-radius: 30px; border: 3px solid rgba(255, 255, 255, 0.9); box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 20px; width: 90%; max-width: 800px; }
        .school-logo { width: 80px; height: auto; margin-bottom: 5px; }
        .school-name { font-family: 'Sarabun'; font-size: 28px; font-weight: 900; color: #1B5E20; text-shadow: 1px 1px 0 #fff; margin: 0; }
        .teacher-info { font-size: 22px; font-weight: 800; color: #333; margin: 5px 0; }
        .subject-name { font-size: 18px; font-weight: 700; color: #d35400; margin-bottom: 5px; }
        .game-title { font-family: 'Chonburi'; font-size: 40px; color: #0D47A1; -webkit-text-stroke: 1.5px #2E7D32; text-shadow: 3px 3px 0px rgba(0, 33, 113, 0.3); margin-top: 5px; }
        #level-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: flex; justify-content: center; align-items: center; flex-direction: column; z-index: 200; backdrop-filter: blur(15px); }
        .level-btn { width: 280px; padding: 25px; margin: 15px; font-size: 28px; border-radius: 50px; border: none; cursor: pointer; font-weight: 800; transition: 0.3s; box-shadow: 0 8px 0 rgba(0,0,0,0.2); }
        .btn-k { background: #FFEB3B; color: #E65100; }
        .btn-p { background: #4CAF50; color: white; }
        .game-card { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(8px); border-radius: 35px; padding: 20px; flex: 1; min-width: 320px; display: flex; flex-direction: column; align-items: center; border: 4px solid rgba(255, 255, 255, 0.5); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .cloud-number { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M18.42 9.22a5.98 5.98 0 0 0-9.84-2.7 6 6 0 0 0-8.58 5.48h.01A6 6 0 0 0 6 18h12a6 6 0 0 0 .42-11.98z"/></svg>'); background-repeat: no-repeat; background-size: contain; background-position: center; width: 180px; height: 110px; display: flex; justify-content: center; align-items: center; font-size: 35px; font-weight: 900; color: #01579B; text-align: center; }
        .spawner { cursor: pointer; transition: transform 0.1s; margin: 10px 0; }
        .spawner img { width: 90px; height: auto; }
        .drop-zone { width: 240px; min-height: 140px; background-size: contain; background-repeat: no-repeat; background-position: center bottom; display: flex; flex-wrap: wrap; justify-content: center; align-items: flex-end; background-color: rgba(255,255,255,0.4); border-radius: 20px; padding: 10px; }
        .btn-undo { width: 50px; height: 50px; background: #FF5252; color: white; border-radius: 15px; border: none; font-size: 24px; cursor: pointer; box-shadow: 0 5px 0 #D32F2F; margin-left: 10px; }
        .btn-check { background: linear-gradient(to bottom, #66BB6A, #388E3C); color: white; border: none; padding: 12px 40px; border-radius: 50px; font-size: 24px; font-weight: bold; cursor: pointer; box-shadow: 0 6px 0 #1B5E20; margin-top: 15px; }
        #change-level-container { margin-top: 20px; display: none; }
        .btn-switch { background: #FB8C00; color: white; padding: 10px 25px; border-radius: 30px; border: none; font-weight: bold; cursor: pointer; box-shadow: 0 4px 0 #E65100; }
        #victory-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: none; justify-content: center; align-items: center; flex-direction: column; z-index: 100; backdrop-filter: blur(10px); }
        .item-small { width: 45px; height: 45px; margin: 2px; animation: pop 0.3s; }
        @keyframes pop { from {transform: scale(0);} to {transform: scale(1);} }
    </style>
</head>
<body>
    <div class="sky-bg"></div><div class="hill-far"></div><div class="hill-near"></div>
    <audio id="bgMusic" src="bg.mp3" loop></audio>

    <div id="level-overlay">
        <h1 style="color:white; font-size: 2.5em; text-shadow: 3px 3px 0 #000; margin-bottom: 30px; text-align: center;">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö!<br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</h1>
        <button class="level-btn btn-k" onclick="selectLevel('K')">‡∏£‡∏∞‡∏î‡∏±‡∏ö ‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•<br>(‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô)</button>
        <button class="level-btn btn-p" onclick="selectLevel('P')">‡∏£‡∏∞‡∏î‡∏±‡∏ö ‡∏õ‡∏£‡∏∞‡∏ñ‡∏°<br>(‡∏ö‡∏ß‡∏Å‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡πÄ‡∏•‡∏Ç)</button>
    </div>

    <div id="victory-overlay">
        <h1 id="victory-msg" style="color:#2ECC71; font-size: 3em; text-align:center;">üéâ ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö! üéâ</h1>
        <h2 id="lang-feedback" style="color: white; text-align: center; margin-bottom: 30px;"></h2>
        <button class="level-btn btn-k" onclick="initGame()" style="width: 200px; font-size: 20px;">‡πÄ‡∏•‡πà‡∏ô‡∏£‡∏≠‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏õ</button>
    </div>

    <header>
        <img src="logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ" class="school-logo" onerror="this.src='https://banmai.ac.th/wp-content/uploads/2023/06/cropped-logo-school.png'">
        <div class="school-name">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ß‡∏±‡∏í‡∏ô‡∏≤</div>
        <div class="teacher-info">‡∏Ñ‡∏£‡∏π‡∏Ç‡∏±‡∏ô‡∏ó‡∏≠‡∏á ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡πÄ‡∏ï‡∏µ‡πâ‡∏¢</div>
        <div class="subject-name">‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</div>
        <div class="game-title" id="mode-title">‡πÄ‡∏Å‡∏°‡∏ô‡∏±‡∏ö ‡πÑ‡∏Å‡πà ‡πÑ‡∏Ç‡πà ‡∏°‡∏´‡∏≤‡∏™‡∏ô‡∏∏‡∏Å</div>
    </header>

    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; width: 100%; max-width: 950px;">
        <div class="game-card">
            <div class="cloud-number" id="target-1">?</div>
            <div class="spawner" onclick="addItem(1)">
                <img id="spawner-img-1" src="chicken.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1828/1828884.png'">
            </div>
            <div style="display:flex; align-items:center;">
                <div class="drop-zone" id="zone-1" style="background-image: url('coop.png');"></div>
                <button class="btn-undo" onclick="removeItem(1)">‚ùå</button>
            </div>
            <button class="btn-check" id="btn-1" onclick="checkAnswer(1)">‚úÖ ‡∏ï‡∏≠‡∏ö</button>
            <div id="fb-1" style="height:25px; margin-top:5px; font-weight:bold;"></div>
        </div>
        <div class="game-card">
            <div class="cloud-number" id="target-2">?</div>
            <div class="spawner" onclick="addItem(2)">
                <img id="spawner-img-2" src="egg.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/2932/2932688.png'">
            </div>
            <div style="display:flex; align-items:center;">
                <div class="drop-zone" id="zone-2" style="background-image: url('nest.png');"></div>
                <button class="btn-undo" onclick="removeItem(2)">‚ùå</button>
            </div>
            <button class="btn-check" id="btn-2" onclick="checkAnswer(2)">‚úÖ ‡∏ï‡∏≠‡∏ö</button>
            <div id="fb-2" style="height:25px; margin-top:5px; font-weight:bold;"></div>
        </div>
    </div>
    <div id="change-level-container"><button class="btn-switch" onclick="showLevelSelect()">üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</button></div>

    <script>
        let currentMode = 'K', t1 = 0, t2 = 0, c1 = 0, c2 = 0, is1Correct = false, is2Correct = false;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const langData = {
            0: { th: "‡∏®‡∏π‡∏ô‡∏¢‡πå", en: "Zero", cn: "L√≠ng" },
            1: { th: "‡∏´‡∏ô‡∏∂‡πà‡∏á", en: "One", cn: "Yƒ´" },
            2: { th: "‡∏™‡∏≠‡∏á", en: "Two", cn: "√àr" },
            3: { th: "‡∏™‡∏≤‡∏°", en: "Three", cn: "SƒÅn" },
            4: { th: "‡∏™‡∏µ‡πà", en: "Four", cn: "S√¨" },
            5: { th: "‡∏´‡πâ‡∏≤", en: "Five", cn: "W«î" },
            6: { th: "‡∏´‡∏Å", en: "Six", cn: "Li√π" },
            7: { th: "‡πÄ‡∏à‡πá‡∏î", en: "Seven", cn: "Qƒ´" },
            8: { th: "‡πÅ‡∏õ‡∏î", en: "Eight", cn: "BƒÅ" },
            9: { th: "‡πÄ‡∏Å‡πâ‡∏≤", en: "Nine", cn: "Ji«î" },
            10: { th: "‡∏™‡∏¥‡∏ö", en: "Ten", cn: "Sh√≠" }
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
        function unlockVoice() {
            const msg = new SpeechSynthesisUtterance('');
            window.speechSynthesis.speak(msg);
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playEffect(freq) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.1);
        }

        function selectLevel(lv) {
            currentMode = lv;
            unlockVoice(); // ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏∞
            document.getElementById('bgMusic').volume = 0.2;
            document.getElementById('bgMusic').play();
            document.getElementById('level-overlay').style.display = 'none';
            document.getElementById('mode-title').innerText = (lv === 'K') ? "‡πÄ‡∏Å‡∏°‡∏ô‡∏±‡∏ö ‡πÑ‡∏Å‡πà ‡πÑ‡∏Ç‡πà (‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•)" : "‡πÄ‡∏Å‡∏°‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡πÑ‡∏Å‡πà ‡πÑ‡∏Ç‡πà (‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ñ‡∏°)";
            initGame();
        }

        function initGame() {
            document.getElementById('victory-overlay').style.display = 'none';
            is1Correct = false; is2Correct = false;
            document.getElementById('btn-1').disabled = false; document.getElementById('btn-2').disabled = false;
            c1 = 0; c2 = 0;
            document.getElementById('zone-1').innerHTML = ''; document.getElementById('zone-2').innerHTML = '';
            document.getElementById('fb-1').innerText = ''; document.getElementById('fb-2').innerText = '';
            t1 = generateProblem(1); t2 = generateProblem(2);
        }

        function generateProblem(id) {
            let cloud = document.getElementById('target-' + id);
            if (currentMode === 'K') {
                let num = Math.floor(Math.random() * 9) + 1;
                cloud.innerText = num; return num;
            } else {
                let isPlus = Math.random() > 0.5;
                if (isPlus) {
                    let a = Math.floor(Math.random() * 5) + 1, b = Math.floor(Math.random() * 4) + 1;
                    cloud.innerHTML = `<span style="font-size:22px">${a}+${b}</span><br>=?`; return a + b;
                } else {
                    let a = Math.floor(Math.random() * 5) + 5, b = Math.floor(Math.random() * 5);
                    cloud.innerHTML = `<span style="font-size:22px">${a}-${b}</span><br>=?`; return a - b;
                }
            }
        }

        function addItem(n) {
            if ((n === 1 && is1Correct) || (n === 2 && is2Correct)) return;
            playEffect(600);
            const img = document.createElement('img');
            img.src = (n === 1) ? 'chicken.png' : 'egg.png';
            img.className = 'item-small';
            img.onerror = function() { this.src = (n === 1) ? 'https://cdn-icons-png.flaticon.com/512/1828/1828884.png' : 'https://cdn-icons-png.flaticon.com/512/2932/2932688.png'; };
            document.getElementById('zone-' + n).appendChild(img);
            if (n === 1) c1++; else c2++;
        }

        function removeItem(n) {
            if ((n === 1 && is1Correct) || (n === 2 && is2Correct)) return;
            playEffect(400);
            const zone = document.getElementById('zone-' + n);
            if (zone.lastChild) { zone.removeChild(zone.lastChild); if (n === 1) c1--; else c2--; }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏π‡∏î 3 ‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
        function speak3Lang() {
            const total = is2Correct ? t2 : t1;
            const data = langData[total];
            if (!data) return;
            document.getElementById('lang-feedback').innerHTML = `‡πÑ‡∏ó‡∏¢: ${data.th} | English: ${data.en} | Chinese: ${data.cn}`;
            
            // ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö Queue ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ await ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
            window.speechSynthesis.cancel(); 
            
            let t = new SpeechSynthesisUtterance(data.th); t.lang = 'th-TH';
            let e = new SpeechSynthesisUtterance(data.en); e.lang = 'en-US';
            let c = new SpeechSynthesisUtterance(data.cn); c.lang = 'zh-CN';
            
            window.speechSynthesis.speak(t);
            window.speechSynthesis.speak(e);
            window.speechSynthesis.speak(c);
        }

        function simpleSpeak(text) {
            window.speechSynthesis.cancel();
            let msg = new SpeechSynthesisUtterance(text);
            msg.lang = 'th-TH';
            window.speechSynthesis.speak(msg);
        }

        function checkAnswer(n) {
            let target = (n === 1) ? t1 : t2, current = (n === 1) ? c1 : c2;
            let fb = document.getElementById('fb-' + n);
            if (target === current) {
                fb.innerText = "üéâ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!"; fb.style.color = "green";
                if (n === 1) is1Correct = true; else is2Correct = true;
                document.getElementById('btn-' + n).disabled = true;
                if (is1Correct && is2Correct) {
                    document.getElementById('victory-overlay').style.display = 'flex';
                    document.getElementById('change-level-container').style.display = 'block';
                    speak3Lang();
                } else { simpleSpeak("‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö"); }
            } else {
                fb.innerText = "‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡∏∞"; fb.style.color = "red";
                simpleSpeak("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö");
            }
        }
        function showLevelSelect() { document.getElementById('level-overlay').style.display = 'flex'; document.getElementById('change-level-container').style.display = 'none'; }
    </script>
</body>
</html>